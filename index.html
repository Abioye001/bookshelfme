<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BookShelf Organizer</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet">

</head>
<body>
<div class="container-fluid mt-5 q w-50">
    <div class="container mt-3 mx-auto shadow p-4 rounded">
        <h3 class="text-center text-decoration-underline mb-4">BookShelf Organizer</h3>
        <div class="alert alert-danger" role="alert" style="display: none;" id="warningMsg">
            Please enter a book title!
        </div>
        <div class="input-group mb-3">
            <input type="text" class="form-control" placeholder="Enter a book title" id="bookInput">
            <button class="btn btn-success" onclick="addBook()">Add Book</button>
        </div>
        <div class="d-flex gap-2 mb-3">
            <button class="btn btn-danger w-50" onclick="deleteAllBooks()">Delete All</button>
            <button class="btn btn-primary w-50" onclick="sortBooks('asc')">Sort Ascending</button>
            <button class="btn btn-primary w-50" onclick="sortBooks('desc')">Sort Descending</button>
        </div>
        <div class="filter-section">
            <div class="input-group mb-2">
                <input type="text" class="form-control" placeholder="Search by title" id="searchInput" oninput="searchBooks()">
                <button class="btn btn-outline-secondary" onclick="searchBooks()">Search</button>
            </div>
            <div class="input-group mb-2">
                <input type="number" class="form-control" placeholder="Search by index" id="indexInput" min="0" oninput="searchByIndex()">
                <button class="btn btn-outline-secondary" onclick="searchByIndex()">Search</button>
            </div>
            <div class="input-group">
                <select class="form-select" id="letterFilter" onchange="filterByLetter()">
                    <option value="">Filter by starting letter</option>
                    <option value="All">All</option>
                    <option value="A">A</option><option value="B">B</option><option value="C">C</option>
                </select>
            </div>
        </div>
        <div id="bookScreen" class="book-list mt-3"></div>
    </div>
</div>

<script>
    let allBooks = [];
    let filteredBooks = [];
    let editBookIndex = null;
    let bookScreen = document.getElementById("bookScreen");

    function addBook() {
        let book = document.getElementById("bookInput").value.trim();
        let warningMsg = document.getElementById("warningMsg");

        if (!book) {
            warningMsg.style.display = "block";
            return;
        }
        warningMsg.style.display = "none";
        if (editBookIndex === null) {
            allBooks.push(book);
        } else {
            allBooks[editBookIndex] = book;
            editBookIndex = null;
        }
        filteredBooks = [...allBooks];
        displayBooks();
        document.getElementById("bookInput").value = "";
    }

    function displayBooks() {
        bookScreen.innerHTML = "";
        let htmlList = "<ol>";
        for (let i = 0; i < filteredBooks.length; i++) {
            htmlList += `<li>${filteredBooks[i]} 
                <button class="btn btn-warning btn-sm ms-2" onclick="editBook(${i})">Edit</button>
                <button class="btn btn-danger btn-sm ms-1" onclick="deleteBook(${i})">Delete</button>
            </li>`;
        }
        htmlList += "</ol>";
        bookScreen.innerHTML = htmlList || "<p>No books to display.</p>";
    }

    function deleteBook(index) {
        let actualIndex = allBooks.indexOf(filteredBooks[index]);
        allBooks.splice(actualIndex, 1);
        filteredBooks = [...allBooks];
        displayBooks();
    }

    function deleteAllBooks() {
        if (confirm("Are you sure you want to delete all books?")) {
            allBooks = [];
            filteredBooks = [];
            displayBooks();
            document.getElementById("searchInput").value = "";
            document.getElementById("indexInput").value = "";
            document.getElementById("letterFilter").value = "";
        }
    }

    function editBook(index) {
        document.getElementById("bookInput").value = filteredBooks[index];
        editBookIndex = allBooks.indexOf(filteredBooks[index]);
    }

    function sortBooks(order) {
        filteredBooks.sort((a, b) => order === 'asc' ? a.localeCompare(b) : b.localeCompare(a));
        allBooks = [...filteredBooks];
        displayBooks();
    }

    function searchBooks() {
        let query = document.getElementById("searchInput").value.trim().toLowerCase();
        filteredBooks = allBooks.filter(book => book.toLowerCase().includes(query));
        document.getElementById("indexInput").value = "";
        document.getElementById("letterFilter").value = "";
        displayBooks();
    }

    function searchByIndex() {
        let index = parseInt(document.getElementById("indexInput").value);
        document.getElementById("searchInput").value = "";
        document.getElementById("letterFilter").value = "";
        if (isNaN(index) || index < 0 || index >= allBooks.length) {
            filteredBooks = [...allBooks];
        } else {
            filteredBooks = [allBooks[index]];
        }
        displayBooks();
    }

    function filterByLetter() {
        let letter = document.getElementById("letterFilter").value;
        document.getElementById("searchInput").value = "";
        document.getElementById("indexInput").value = "";
        if (letter === "All" || !letter) {
            filteredBooks = [...allBooks];
        } else {
            filteredBooks = allBooks.filter(book => book.toUpperCase().startsWith(letter));
        }
        displayBooks();
    }
</script>
</body>
</html>